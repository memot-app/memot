---
export interface Props {
  message: string;
  rotateX?: number;
  rotateY?: number;
  rotateZ?: number;
  shadowDirection?: "bottom-left" | "bottom-right";
  class?: string;
  enableTextAnimation?: boolean;
}

const {
  message,
  rotateX = 0,
  rotateY = 0,
  rotateZ = 0,
  shadowDirection = "bottom-left",
  class: className = "",
  enableTextAnimation = false,
} = Astro.props;

const shadowClass =
  shadowDirection === "bottom-left"
    ? "shadow-[-5px_5px_0_0_#404040]"
    : "shadow-[5px_5px_0_0_#404040]";

const borderRadius =
  shadowDirection === "bottom-left"
    ? "2.88px 17.282px 17.282px 17.282px"
    : "17.282px 2.88px 17.282px 17.282px";

// ユニークなIDを生成
const cardId = `message-card-${Math.random().toString(36).substr(2, 9)}`;
---

<div
  class={`inline-block px-[clamp(0.75rem,1.2vw,1.25rem)] py-[clamp(0.5rem,1.2vw,1rem)] bg-white border-[2.304px] border-black ${shadowClass} max-w-[clamp(100px,25vw,280px)] ${className}`}
  style={`
    border-radius: ${borderRadius};
    transform: rotateX(${rotateX}deg) rotateY(${rotateY}deg) rotateZ(${rotateZ}deg);
    transform-style: preserve-3d;
  `}
  data-card-id={cardId}
  data-enable-text-animation={enableTextAnimation}
  data-message={message}
>
  <span
    class="text-black font-medium text-[clamp(0.75rem,1.2vw,0.95rem)] leading-7 break-words block message-text"
    style={enableTextAnimation ? "opacity: 0;" : ""}
  >
    {message}
  </span>
</div>
